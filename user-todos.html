<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User ToDos</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <div class="navbar">
        <a href="index.html">Home</a>
        <a href="user-todos.html">ToDo List</a>
        <a href="new-todo.html">Add New ToDo</a>
        <a href="new_user.html">Register New User</a>
    </div>
 
    <div class="container">
        <h1>User ToDos</h1>
        <label for="userSelect">Select User:</label>
        <select id="userSelect">
            <!-- Options will be populated dynamically -->
        </select>
        <div id="todoList">
            <!-- ToDo list will be populated dynamically -->
        </div>
    </div>
    <script>
        // Fetch registered users and populate the dropdown
        fetch('api/users')
            .then(response => response.json())
            .then(users => {
                const userSelect = document.getElementById('userSelect');
                users.forEach(user => {
                    const option = document.createElement('option');
        option.value = user.id;
        option.textContent = user.name;
                    userSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error fetching users:', error));
         
        // Fetch and display ToDo tasks when a user is selected
        document.getElementById('userSelect').addEventListener('change', function() {
            const userId = this.value;
            fetch(`api/todos/byuser/${userId}`)
                .then(response => response.json())
                .then(todos => {
                    const todoList = document.getElementById('todoList');
                    todoList.innerHTML = ''; // Clear the previous tasks
         
                    todos.forEach(todo => {
                        const todoItem = document.createElement('div');
                        todoItem.className = 'todo-item';
         
                        const completedIcon = todo.completed ? 'âœ“' : 'X';
                      //  const completedIconImg = `<img src="${completedIcon}.png" class="completed-icon" alt="${completedIcon}">`;
         
                        todoItem.innerHTML = `
                            <strong>Description:</strong> ${todo.description} <br>
                            <strong>Deadline:</strong> ${todo.deadline} <br>
                            <strong>Completed:</strong> ${completedIcon} <br>
        <a href="todo-details.html?id=${todo.id}">See Details</a>
                        `;
                        todoList.appendChild(todoItem);
                    });
                })
                .catch(error => console.error('Error fetching ToDos:', error));
        });
        </script>
        
</body>
</html>

